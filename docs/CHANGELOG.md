# Changelog

## 2026-01-22
- Added BIOL202 section slide generation inputs and a BIOL202 runbook documenting the multi-step slide pipeline.
- Added BIOL202 helper scripts to deduplicate merged CSVs and generate a logically ordered lecture CSV aligned to OpenStax Chapter 44 sections.
- Added remove_duplicate_slides_from_csv.py to randomly deduplicate slide CSV rows by slide_hash for merged.csv style inputs.
- Added set_master_name_in_csv.py to overwrite master_name across a merged/index CSV for consistent template/master selection.
- Added pytest coverage for the CSV helper scripts that set master_name and randomly deduplicate by slide_hash.
- Fixed rebuild image insertion for placeholders that do not expose insert_picture() in python-pptx by falling back to absolute placement.
- Fixed rebuild template handling to clear template slides robustly (including dropping template references that can cause duplicate slide XML on save).
- Updated text-to-slides template slide clearing to drop template references to removed slides.
- Added a regression test ensuring rebuild with a template does not keep the template's existing slides.

## 2026-01-20
- Added the concept implementation plan document.
- Updated the plan to reflect CSV-only merging and ODP conversion support.
- Added initial indexing/rebuild scripts and shared CSV utilities.
- Added slide CSV unit tests.
- Added architecture and file structure documentation.
- Linked architecture docs from the README.
- Added install and usage documentation stubs.
- Added non-IO unit tests for index and rebuild helpers.
- Skipped tests for commit_changelog due to subprocess and git usage.
- Added docset stubs for news, related projects, release history, roadmap, todo,
  and troubleshooting.
- Updated the documentation map to include the new docs.
- Refreshed the README structure and doc links.
- Clarified the README overview audience.
- Added a merged CSV validation script and tests.
- Documented the validation CLI in usage docs and file structure.
- Switched to CSV indexing without exported assets and removed assets-dir usage.
- Defaulted index/rebuild outputs to input filenames with new extensions.
- Renamed the index script and updated docs to match index-only behavior.
- Added image locators to the CSV schema and rebuild resolution logic.
- Updated architecture, usage, and concept docs to reflect locator-based rebuilds.
- Renamed `extract_slides.py` to `index_slide_deck.py`.
- Added shebangs to CLI scripts and fixed ODP source conversion in rebuild.
- Added a theme and layout planning document.
- Refined the theme and layout plan with template-driven geometry and overflow rules.
- Fixed pytest path setup so repo-root imports resolve from any working directory.
- Removed the shebang from pytest conftest to satisfy shebang checks.
- Finalized theme overflow behavior and clarified locator stability rules.
- Added a text editing plan for scoped, deterministic slide text updates.
- Moved shared CSV logic into the slide_deck_pipeline package.
- Clarified text editing plan details for placeholders, hashes, and bullets.
- Switched text edit plans to a YAML patch format with box ids and fingerprints.
- Updated theme plan to use template-defined aspect ratios.
- Updated validation checks to defer text fitting to the office app.
- Updated aspect ratio policy to avoid stretched images.
- Replaced slide_type with master_name and layout_name columns in the theme plan.
- Removed per-image locator and fit metadata from the theme plan CSV additions.
- Removed template_name from the theme plan CSV additions.
- Simplified image fit policy to contain-only.
- Added template/master/layout definitions to the theme plan.
- Added a theme definition and aligned typography overflow handling with autofit.
- Clarified template deck terminology and removed theme scope from the layout plan.
- Renamed the layout plan to docs/TEMPLATE_LAYOUT_PLAN.md.
- Replaced the layout registry section with layout selection rules.
- Clarified that CSV is only for slide ordering/selection and text edits use YAML.
- Clarified that CSV text fields are context-only and not editable.
- Moved wide text fields to the end of the CSV column order.
- Defined CSV columns and layout_hint usage in the plans.
- Shortened slide_uid to a CRC32 hex value.
- Updated layout and concept plans with the final CSV column definitions and
  slide_hash integrity behavior.
- Aligned text editing plan YAML fields with CSV naming and CRC-style hashes.
- Defined slide/text hash truncation policy using SHA-256 with 16 hex characters.
- Updated the CSV schema to master/layout columns and SHA-256 slide hashes.
- Refreshed index, rebuild, and validation logic to enforce slide hash integrity.
- Added shared slide text and text box helpers for text edit workflows.
- Added export and apply text edit CLI tools with YAML patch support.
- Updated usage, architecture, and file structure docs for the text edit flow.
- Updated tests to match the new CSV schema and hash behavior.
- Added the asset_types CSV column to capture non-editable slide asset context.
- Preferred the LibreOffice app soffice binary for ODP conversions on macOS.
- Centralized soffice conversion helpers in slide_deck_pipeline/soffice_tools.py.
- Added --headless, --norestore, and --safe-mode flags to soffice conversions.
- Added a small pipeline smoke test that builds, indexes, merges, and rebuilds PPTX files.
- Fixed rebuild slide dimension lookup to support python-pptx slide parts without presentation attributes.
- Added a test_script.sh helper to index PPTX files, merge CSVs, and rebuild a combined deck.
- Added a layout-name fallback when slide layouts have multiple relationships.
- Sanitized CSV context fields to strip commas, tabs, newlines, and non-ascii characters.
- Skipped repeated header rows when reading merged CSVs.
- Updated slide hashes to use slide XML plus notes text instead of image hashes.

## 2026-01-21
- Removed unused slide text extraction now that slide hashes derive from slide XML.
- Switched slide XML normalization to lxml with safe parsing and relationship hashing.
- Centralized slide hash computation in slide_deck_pipeline/pptx_hash.py.
- Updated test_script.sh to merge CSVs with a single header and stable sorting.
- Dropped index warnings for slides with no text and hashed slides before body text extraction.
- Added configurable sort column and numeric toggle to test_script.sh.
- Added pytest coverage for slide hash stability and indexing order.
- Normalized master_name in test_script.sh so all merged rows share one master.
- Added status echo output to test_script.sh for each step.
- Simplified test_script.sh sorting to a single SORT_NUMERIC column setting.
- Added relationship-aware slide hashing to ignore volatile ids while keeping assets/layouts.
- Added Brewfile and pip_requirements.txt dependency manifests.
- Updated docs/INSTALL.md with dependency manifest instructions.
- Added pip_requirements-dev.txt for test tooling dependencies.
- Added headerless CSV support and tests for it.
- Updated test_script.sh to use header.csv for easier sorting and filtering.
- Allowed header rows anywhere in CSV inputs and ignore them during parsing.
- Normalized relationship payloads with XML normalization and added tests.
- Added layout_type column and layout classifier helper module.
- Guarded layout classifier placeholder enums for compatibility.
- Replaced layout_name with layout_type in the CSV and rebuild selection logic.
- Added pytest coverage for layout classification.
- Added layout confidence and reason metadata to layout classification output.
- Removed layout_type_override and kept layout_type as the editable selector.
- Dropped layout_confidence and layout_reasons from the CSV schema while keeping
  a deck-level layout confidence summary during indexing.
- Added a lecture merge guide covering CSV-driven sorting and rebuild steps.
- Added docs/TEXT_TO_SLIDES_PLAN.md describing the text-to-slides pipeline plan.
- Aligned text-to-slides terminology to use layout_type in YAML and mapping.
- Clarified text-to-slides template deck modes and optional master usage.
- Documented the allowed layout_type values for text-to-slides.
- Expanded text-to-slides layout_type support to the full 12 Impress layouts
  with snake_case names and alias normalization.
- Reconciled text-to-slides goals, schema, and template contract for 12 layout
  types with multi-body support.
- Added a layout_type placeholder count table for the text-to-slides schema.
- Added an image insertion spec and shared path resolution rules to the
  text-to-slides plan.
- Clarified Markdown type line parsing and conditional template validation for
  text-to-slides.
- Added text-to-slides implementation modules, CLI scripts, and tests.
- Added shared path resolution for PPTX/assets and wired it into pipeline tools.
- Reworked slide hashing to use ordered shape tokens, geometry, text hashes, and
  image blobs plus notes text for stable structural hashes.
- Added slide hash tests that cover shape order changes and picture changes.
- Updated plan docs to describe structural slide hash inputs.
- Added docs/MC_TO_SLIDES.md with the multiple-choice deck plan.
- Added strict mode and text normalization details to the MC plan.
- Added MC parser, template handling, and rendering pipeline for quiz text decks.
- Added mc_to_slides CLI and tests for MC parsing, templates, and rendering.
- Escaped non-ASCII bullet glyphs in the MC template source XML.
- Marked mc_to_slides.py as executable to match the shebang policy.
- Centralized PPTX/ODP input resolution in slide_deck_pipeline/pptx_io.py.
- Reused the shared PPTX resolver in index, export, and apply scripts.
- Named MC template shapes directly in the unzipped slide XML.
- Updated README docs links to include the MC plan and clarify scope.
- Added slide_deck_pipeline/text_normalization.py for shared whitespace parsing.
- Reused shared text normalization helpers in MC, rebuild, and text edit flows.
- Centralized CSV source path resolution in slide_deck_pipeline/path_resolver.py.
- Moved index, rebuild, export, and apply helpers into slide_deck_pipeline modules.
- Added shared text editing, text export, rebuild, and indexing helper modules.
- Added a shared CSV validation module and thin CLI wrapper.
- Reduced root CLI scripts to thin entrypoints that call library code.
- Added a text edit pipeline guide for export/apply workflows.
- Added a text-to-slides pipeline guide for Markdown and YAML rendering.
- Added a multiple-choice slides pipeline guide for quiz text decks.
- Refocused README on the four pipelines with guide and plan links.
- Added merge_index_csv_files.py to merge index CSVs with glob support and sorting.
- Documented the merge helper in usage and lecture merge guide.
- Refreshed code architecture and file structure docs for new pipeline scripts.
- Treat object/content/text placeholders as body text boxes in export/apply.
- Allowed apply_text_edits.py to infer input decks from YAML patches.
- Defaulted apply_text_edits.py to prevent in-place edits without --inplace.
- Added aspect_fixer.py to restore image aspect ratios in PPTX or ODP files.
- Preserve image aspect ratios during rebuild image placement.
- Simplified apply_text_edits.py to accept only YAML patch inputs.
- Reported apply_text_edits.py output path in CLI.
- Reported aspect_fixer.py output path in CLI.
- Reported output paths for all root-level CLI scripts.
